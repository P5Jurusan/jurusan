<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <style>
        body {
            background-color: #f3f4ff;
            font-family: 'Jost', sans-serif;
        }

        .container {
            max-width: 100%;
            overflow-x: hidden;
        }

        .header {
            justify-content: space-between;
        }

        .card {
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: none;
        }

        .card-body {
            max-height: 300px;
            /* Sesuaikan dengan tinggi yang Anda inginkan */
            overflow-y: auto;
            /* Menambahkan scroll vertikal ketika konten melebihi tinggi */
        }


        .full-card-input {
            border-radius: 15px;
            border: none;
            outline: none;
            padding: 10px;
            font-size: 16px;
            box-sizing: border-box;
        }

        textarea::placeholder {
            color: #CED3F5;
        }

        /* guru */
        .profile-img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #d3d3d3;
            margin: 0 auto 20px;
        }

        .btn-custom {
            border-radius: 20px;
            padding: 10px 20px;
            margin-bottom: 10px;
            width: 100%;
        }

        .btn-name {
            color: #5a5a5a;
            background-color: #f0f0f0;
        }

        .btn-description {
            color: #d3d3d3;
            background-color: #f9f9f9;
        }

        /* jurusan */
        .class-info {
            color: #E0E0E0;
            font-size: 1rem;
        }

        .dot {
            height: 10px;
            width: 10px;
            background-color: #D0D0F0;
            border-radius: 50%;
            display: inline-block;
            flex-shrink: 0;
        }

        /* upload */
        .upload-card {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .upload-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .upload-footer {
            background-color: #5A67D8;
            color: white;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .upload-footer span {
            font-size: 14px;
            margin-right: 10px;
        }

        .upload-footer i {
            font-size: 1.5rem;
        }

        .divider {
            height: 24px;
            width: 1px;
            background-color: white;
            margin: 0 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header d-flex align-items-center mt-2 mb-2">
            <h4 class="title" style="color: #5562B3; flex-grow: 1; margin: 0;">
                <strong>HALAMAN ADMIN</strong>
            </h4>
            <button
                style="border: none; background: transparent; cursor: pointer; padding: 0; color: #5562B3; font-size: 1.5rem;"
                title="Sign Out">
                <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
            </button>
        </div>


        <!-- baris 1 -->
        <div class="d-flex mb-3">
            <div class="container-fluid px-0">
                <div class="row">

                    <!-- input text dan upload 1 -->
                    <div class="col-3">
                        <div class="card" style="height: 160px; position: relative;">
                            <div class="card-body"
                                style="display: flex; align-items: center; justify-content: center; height: 100%;">
                                <form action="/admin/informations" method="POST" style="width: 100%; height: 100%;"
                                    enctype="multipart/form-data">
                                    <textarea name="description" placeholder="Ketik Informasi Terkini ..." style="position: absolute; top: 10px; left: 10px; right: 10px; bottom: 50px; 
                                                 max-height: calc(100% - 50px); width: calc(100% - 20px); 
                                                 border: none; outline: none; font-size: 18px; 
                                                 resize: none; overflow-y: auto; padding: 5px;">
                </textarea>
                                    <button type="submit"
                                        style="position: absolute; bottom: 10px; right: 10px; font-size: 13px; padding: 5px 10px; border: none; color: #ffffff; background-color: #5562B3; border-radius: 7px;">
                                        Simpan
                                    </button>
                            </div>
                        </div>
                    </div>

                    <!-- upload 1 -->
                    <div class="col-3">
                        <div class="card" style="height: 160px;">
                            <div class="card-body p-0">
                                <div class="upload-card">
                                    <!-- Gambar yang akan diperbarui -->
                                    <img id="previewImage1" src="https://placehold.co/600x400" alt="Preview Image">
                                    <div class="upload-footer" style="height: 40px;">
                                        <label style="cursor: pointer;">
                                            <span>Upload Foto</span>
                                            <input type="file" id="imageInput1" accept="image/*"
                                                style="display: none;" />
                                        </label>
                                        <div class="divider"></div>
                                        <label style="cursor: pointer;">
                                            <i class="fas fa-camera"></i>
                                            <input type="file" id="imageInput1" name="image_path" accept="image/*"
                                                style="display: none;" />
                                        </label>
                                    </div>
                                </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!--   card input 2 -->
                    <div class="col-3">
                        <div class="card" style="height: 160px; position: relative;">
                            <div class="card-body" style="padding: 0; position: relative;">
                                <form action="/admin/activities" method="POST" style="width: 100%; height: 100%;"
                                    enctype="multipart/form-data">
                                    <textarea placeholder="Deskripsi Informasi Kegiatan ..." name="description" style="position: absolute; top: 10px; left: 10px; right: 10px; bottom: 50px; 
                                           max-height: calc(100% - 50px); width: calc(100% - 20px); 
                                           border: none; outline: none; font-size: 18px; 
                                           resize: none; overflow-y: auto; padding: 5px;">
                                </textarea>
                                    <button
                                        style="position: absolute; bottom: 10px; right: 10px; font-size: 13px; padding: 5px 10px; border: none; color: #ffffff; background-color: #5562B3; border-radius: 7px;">Simpan</button>
                            </div>
                        </div>
                    </div>

                    <!-- upload 2 -->
                    <div class="col-3">
                        <div class="card" style="height: 160px;">
                            <div class="card-body p-0">
                                <div class="upload-card">
                                    <!-- Gambar yang akan diperbarui -->
                                    <img id="previewImage2" src="https://placehold.co/600x400" alt="Preview Image">
                                    <div class="upload-footer" style="height: 40px;">
                                        <label style="cursor: pointer;">
                                            <span>Upload Foto</span>
                                            <input type="file" id="imageInput2" accept="image/*"
                                                style="display: none;" />
                                        </label>
                                        <div class="divider"></div>
                                        <label style="cursor: pointer;">
                                            <i class="fas fa-camera"></i>
                                            <input type="file" id="imageInput2" name="image_path" accept="image/*"
                                                style="display: none;" />
                                        </label>
                                    </div>
                                </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="d-flex">
            <div class="row mb-3">
                <!-- logo huruf & guru pemb -->
                <div class="col" style="max-width: 255px;">
                    <div class="card mb-3" style="height: 160px; position: relative; width: 230px; overflow: hidden;">
                        <div class="card-body" style="position: relative; padding: 10px; overflow: hidden;">
                            <h5 class="card-title" style="color: #5562B3; font-size: 18px; margin-bottom: 10px;">Logo
                                Text</h5>
                            <form action="/admin/major" method="POST" style="width: 100%; height: 100%;">
                                <textarea placeholder="Tambah Nama Logo" name="name" style="position: absolute; top: 55%; left: 50%; transform: translate(-50%, -50%); 
                                    text-align: center; width: 80%; height: 50px; border: none; outline: none; 
                                    font-size: 18px; resize: none; overflow: hidden;">
                                    {{ major.name if major else '' }}
                                </textarea>
                                <button style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); 
                                    font-size: 13px; padding: 5px 10px; border: none; color: #ffffff; 
                                    background-color: #5562B3; border-radius: 7px;">
                                    Simpan
                                </button>
                            </form>
                        </div>
                    </div>

                    <!-- Guru Pembimbing -->
                    <div class="card mb-3" style="height: 55px;">
                        <button class="card-title btn text-center mt-2"
                            style="background: none; border: none; color: #5562B3; font-size: 19px; cursor: pointer;"
                            onclick="addGuruPembimbing()">
                            Guru Pembimbing +
                        </button>
                    </div>

                    <!-- Kontainer untuk Card Upload Guru -->
                    <form action="/admin/teachers" method="POST" enctype="multipart/form-data">
                        <div id="guru-container">
                            <!-- Kartu guru pembimbing akan ditambahkan di sini -->
                        </div>
                        <button type="submit"
                            style="margin-top: 20px; padding: 10px 20px; border: none; border-radius: 50px; background-color: #717fe0; color: #fff; font-size: 16px; cursor: pointer;">Kirim
                            Semua</button>
                    </form>

                </div>
            </div>

            <!-- data grafik -->
            <div class="col ms-3" style="flex-grow: 1;">
                <div class="card" style="height: 55px; overflow: hidden;">
                    <div class="card-body" style="padding: 10px; overflow: hidden;">
                        <div class="d-flex" style="justify-content: space-between; align-items: center;">
                            <h5 class="card-title" style="color: #5562B3; font-size: 19px; margin: 0;">Data Grafik
                                Diagram</h5>
                            <!-- plus -->
                            <button class="mb-2"
                                style="background: none; border: none; color: #5562B3; font-size: 19px; cursor: pointer; padding: 0;"
                                onmouseover="this.style.color='#334599'" onmouseout="this.style.color='#5562B3'"
                                onclick="addCardLab()">
                                <i class="fa fa-plus mt-2  me-2" aria-hidden="true"></i>
                            </button>
                        </div>
                    </div>
                </div>


                <!-- card add lab -->
                <form action="/admin/lab" method="POST" encytype="multipart/form-data">
                    <div id="card-lab" class="row">
                    </div>
                    <button type="submit"
                        style="margin-top: 20px; padding: 10px 20px; border: none; border-radius: 50px; background-color: #717fe0; color: #fff; font-size: 16px; cursor: pointer;">Kirim
                        Semua</button>
                </form>

                <!-- jumlah siswa -->
                <div class="mt-3">
                    <div class="card" style="height: 55px; overflow: hidden;">
                        <div class="card-body" style="padding: 10px; overflow: hidden;">
                            <div class="d-flex" style="justify-content: space-between; align-items: center;">
                                <h5 class="card-title" style="color: #5562B3; font-size: 19px; margin: 0;">Jumlah Siswa
                                </h5>
                                <!-- plus -->
                                <button class="mb-2"
                                    style="background: none; border: none; color: #5562B3; font-size: 19px; cursor: pointer; padding: 0;"
                                    onmouseover="this.style.color='#334599'" onmouseout="this.style.color='#5562B3'"
                                    onclick="addCardKelas()">
                                    <i class="fa fa-plus mt-2 me-2" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <form action="/admin/student" method="POST" encytype="multipart/form-data">
                        <div class="row" id="card-kelas">
                            <!-- Kartu jumlah siswa dapat ditambahkan di sini -->
                        </div>
                        <button type="submit"
                            style="margin-top: 20px; padding: 10px 20px; border: none; border-radius: 50px; background-color: #717fe0; color: #fff; font-size: 16px; cursor: pointer;">Kirim
                            Semua</button>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
    <script>
        document.querySelectorAll('textarea').forEach(textarea => {
            if (textarea.value.trim() === "") {
                textarea.value = "";
            }
        });

        /* color box */
        const colorPickers = document.querySelectorAll('.colorPicker');

        // Loop melalui setiap color picker
        colorPickers.forEach((picker) => {
            picker.addEventListener('input', (event) => {
                // Dapatkan elemen parent dari picker
                const classBox = picker.parentElement;

                // Ubah warna background berdasarkan pilihan pengguna
                classBox.style.backgroundColor = event.target.value;
            });
        });

        // Fungsi untuk memperbarui gambar dari input file
        function setupImageUpload(inputId, previewId) {
            const imageInput = document.getElementById(inputId);
            const previewImage = document.getElementById(previewId);

            imageInput.addEventListener('change', function (event) {
                // Ambil file yang diupload
                const file = event.target.files[0];

                if (file) {
                    // Buat URL dari file
                    const imageUrl = URL.createObjectURL(file);

                    // Perbarui atribut src dari elemen img
                    previewImage.src = imageUrl;
                }
            });
        }

        // Inisialisasi untuk Upload 1
        setupImageUpload('imageInput1', 'previewImage1');

        // Inisialisasi untuk Upload 2
        setupImageUpload('imageInput2', 'previewImage2');

        /* upload guru */
        function previewImage(event, imageId) {
            const image = document.getElementById(imageId);
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function () {
                image.src = reader.result;
            };

            if (file) {
                reader.readAsDataURL(file);
            }
        }
    </script>

    <script>
        let goodsCount = 0;  // Counter untuk batch

        function addCardLab() {
            goodsCount++;  // Increment untuk setiap batch baru

            const newCard = `
        <div class="col-sm-3 mt-3" id="lab-${goodsCount}">
            <div class="card" style="height: 160px;">
                <div class="card-body">
                    <!-- Nama LAB-->
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <span style="font-size: 18px;">Nama LAB:</span>
                        <input type="text" name="lab_name[]" placeholder="..."
                            style="font-size: 18px; width: 40%; border: none; outline: none; padding: 2px; margin-right: 26px;">
                    </div>

                    <!-- Nama Objek dan Jumlah -->
                    <div class="d-flex flex-column" id="goods-${goodsCount}">
                        <!-- Input barang dinamis akan dimasukkan di sini -->
                    </div>
                    <button type="button" class="btn btn-secondary mt-2" onclick="addGoodsInput(${goodsCount})">Tambah Barang</button>
                </div>
            </div>
        </div>
    `;

            document.getElementById("card-lab").insertAdjacentHTML("beforeend", newCard);
        }

        function addGoodsInput(goodsCount) {
            // Tambahkan input barang dan jumlah untuk lab tertentu
            const goodsDiv = `
        <div class="d-flex flex-column align-items-start mb-1 me-5">
            <span class="dot me-2"></span>
            <div class="mt-2">
                <input type="text" name="object_name_${goodsCount}[]" placeholder="Nama Objek"
                    style="font-size: 12px; width: 100%; border: none; outline: none; background: transparent;">
                <input type="number" name="object_amount_${goodsCount}[]" placeholder="Jumlah"
                    style="font-size: 12px; width: 100%; border: none; outline: none; background: transparent;">
            </div>
        </div>
    `;

            document.getElementById(`goods-${goodsCount}`).insertAdjacentHTML("beforeend", goodsDiv);
        }


        // Function to add a new card below when the plus button is clicked
        let batchCount = 0;  // Counter untuk batch

        function addCardKelas() {
            batchCount++;  // Increment untuk setiap batch baru

            const newCardHTML = `
                <div class="col-sm-4 mt-3" id = "batch-${batchCount}">
                    <div class="card" style="height: 190px;">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="d-flex align-items-center">
                                        <span style="font-size: 16px;">Angkatan</span>
                                        <input type="text" name="batch_year[]" placeholder="Tahun Angkatan"
                                            style="font-size: 16px; border: none; outline: none; margin-left: 2px; width: 50%; background: transparent;">
                                    </div>
                                </div>
                            </div>
                            <div class="d-flex flex-column" id="kelas-${batchCount}">
                                <!-- Input kelas dinamis akan dimasukkan di sini -->
                            </div>
                            <button type="button" class="btn btn-secondary mt-2" onclick="addClassInput(${batchCount})">Tambah Kelas</button>
                        </div>
                    </div>
                `;

            document.getElementById('card-kelas').insertAdjacentHTML('beforeend', newCardHTML);
        }

        function addClassInput(batchCount) {
            // Tambahkan input kelas dan total siswa untuk batch tertentu
            const classDiv = `
                <div class="d-flex flex-column align-items-start mb-1 me-5">
        <span class="dot me-2"></span>
        <div class="mt-2">
            <input type="text" name="class_name_${batchCount}[]" placeholder="Kelas"
                   style="font-size: 12px; width: 100%; border: none; outline: none; background: transparent;">
            <input type="number" name="total_student_${batchCount}[]" placeholder="Jumlah Siswa"
                   style="font-size: 12px; width: 100%; border: none; outline: none; background: transparent;">
        </div>       
        </div>     `;

            document.getElementById(`kelas-${batchCount}`).insertAdjacentHTML('beforeend', classDiv);
        }


        function addGuruPembimbing() {
            const uniqueId = `imageUpload${Date.now()} `;
            const imageId = `guruImage${Date.now()} `;

            const newCard = `
                <div class="card mb-3" style = "height: 260px;">
                    <div class="card-body">
                        <!-- Gambar Guru -->
                        <img src="{{ url_for('static', filename='assets/img/bulat.png') }}" alt="Gambar Guru"
                            class="guruImage"
                            id="${imageId}"
                            style="display: block; margin: 0 auto; width: 120px; height: 120px; border-radius: 50%; object-fit: cover; cursor: pointer;"
                            onclick="document.getElementById('${uniqueId}').click();">

                            <input type="file" id="${uniqueId}" name="profile[]" style="display: none;" accept="image/*" onchange="previewImage(event, '${imageId}')">

                                <input type="text" placeholder="Nama Guru" name="name[]"
                                    style="width: 100%; margin-top: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 50px; font-size: 16px; outline: none; border: none; box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px; text-align: center;">

                                    <input type="text" placeholder="Keterangan" name="title[]"
                                        style="width: 100%; margin-top: 10px; padding: 8px; border: 1px solid #ddd; border-radius: 50px; font-size: 16px; outline: none; border: none; box-shadow: rgba(99, 99, 99, 0.2) 0px 2px 8px 0px; text-align: center;">
                                    </div>
                                </>
    `;

            const container = document.getElementById('guru-container');
            container.insertAdjacentHTML('beforeend', newCard);
        }

    </script>

</body>

</html>